#!/usr/bin/env bash
# 0-change_your_home_IP
# This script updates /etc/hosts to change localhost and facebook.com IPs

# Backup /etc/hosts
cp /etc/hosts /etc/hosts.bak

# Use a temporary file because sed -i may fail
tmpfile=$(mktemp)

# Replace localhost and facebook.com if they exist, or add them if missing
awk '
/^127\.0\.0\.1\s+localhost/ {print "127.0.0.2 localhost"; next}
/facebook\.com/ {next}
{print}
END {
    if (!found_fb) print "8.8.8.8 facebook.com"
}
' found_fb=0 /etc/hosts > "$tmpfile"

# Ensure facebook.com line exists
grep -q "8.8.8.8 facebook.com" "$tmpfile" || echo "8.8.8.8 facebook.com" >> "$tmpfile"

# Overwrite /etc/hosts
cp "$tmpfile" /etc/hosts
rm "$tmpfile"

echo "Hosts file updated successfully."
